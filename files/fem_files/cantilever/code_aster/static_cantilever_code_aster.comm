#
#   COMM file created by ADA (Assembly for Design and Analysis)
#

# Units: N, m

DEBUT(LANG="EN", INFO=1)

mesh = LIRE_MAILLAGE(FORMAT="MED", UNITE=20)

sh_sets = ('elMyBeam_e1_top_fl_sh','elMyBeam_e2_top_fl_sh','elMyBeam_e3_web_sh','elMyBeam_e4_top_fl_sh','elMyBeam_e5_top_fl_sh',)


model = AFFE_MODELE(
    AFFE=(
        _F(GROUP_MA=sh_sets, PHENOMENE='MECANIQUE', MODELISATION='DKT',),
    ),
    MAILLAGE=mesh
)

# Materials
nl_mat=(	
	1.0000E-05,3.2000E+08,4.0000E-03,3.5700E+08,1.5000E-02,3.6610E+08,1.6432E-02,3.7190E+08,
	1.7864E-02,3.7728E+08,1.9296E-02,3.8230E+08,2.0729E-02,3.8701E+08,2.2161E-02,3.9145E+08,
	2.3593E-02,3.9565E+08,2.5025E-02,3.9963E+08,2.6457E-02,4.0343E+08,2.7889E-02,4.0705E+08,
	2.9322E-02,4.1052E+08,3.0754E-02,4.1385E+08,3.2186E-02,4.1705E+08,3.3618E-02,4.2013E+08,
	3.5050E-02,4.2310E+08,3.6482E-02,4.2597E+08,3.7915E-02,4.2874E+08,3.9347E-02,4.3143E+08,
	4.0779E-02,4.3403E+08,4.2211E-02,4.3656E+08,4.3643E-02,4.3902E+08,4.5075E-02,4.4141E+08,
	4.6508E-02,4.4374E+08,4.7940E-02,4.4601E+08,4.9372E-02,4.4822E+08,5.0804E-02,4.5038E+08,
	5.2236E-02,4.5249E+08,5.3668E-02,4.5454E+08,5.5101E-02,4.5656E+08,5.6533E-02,4.5853E+08,
	5.7965E-02,4.6045E+08,5.9397E-02,4.6234E+08,6.0829E-02,4.6419E+08,6.2261E-02,4.6601E+08,
	6.3693E-02,4.6779E+08,6.5126E-02,4.6953E+08,6.6558E-02,4.7125E+08,6.7990E-02,4.7293E+08,
	6.9422E-02,4.7458E+08,7.0854E-02,4.7621E+08,7.2286E-02,4.7780E+08,7.3719E-02,4.7938E+08,
	7.5151E-02,4.8092E+08,7.6583E-02,4.8244E+08,7.8015E-02,4.8394E+08,7.9447E-02,4.8541E+08,
	8.0879E-02,4.8687E+08,8.2312E-02,4.8830E+08,8.3744E-02,4.8971E+08,8.5176E-02,4.9110E+08,
	8.6608E-02,4.9247E+08,8.8040E-02,4.9382E+08,8.9472E-02,4.9515E+08,9.0905E-02,4.9647E+08,
	9.2337E-02,4.9777E+08,9.3769E-02,4.9905E+08,9.5201E-02,5.0031E+08,9.6633E-02,5.0156E+08,
	9.8065E-02,5.0280E+08,9.9497E-02,5.0402E+08,1.0093E-01,5.0522E+08,1.0236E-01,5.0641E+08,
	1.0379E-01,5.0759E+08,1.0523E-01,5.0875E+08,1.0666E-01,5.0990E+08,1.0809E-01,5.1103E+08,
	1.0952E-01,5.1216E+08,1.1095E-01,5.1327E+08,1.1239E-01,5.1437E+08,1.1382E-01,5.1546E+08,
	1.1525E-01,5.1653E+08,1.1668E-01,5.1760E+08,1.1812E-01,5.1865E+08,1.1955E-01,5.1970E+08,
	1.2098E-01,5.2073E+08,1.2241E-01,5.2175E+08,1.2384E-01,5.2277E+08,1.2528E-01,5.2377E+08,
	1.2671E-01,5.2476E+08,1.2814E-01,5.2575E+08,1.2957E-01,5.2672E+08,1.3101E-01,5.2769E+08,
	1.3244E-01,5.2865E+08,1.3387E-01,5.2960E+08,1.3530E-01,5.3054E+08,1.3673E-01,5.3147E+08,
	1.3817E-01,5.3239E+08,1.3960E-01,5.3331E+08,1.4103E-01,5.3422E+08,1.4246E-01,5.3512E+08,
	1.4389E-01,5.3601E+08,1.4533E-01,5.3690E+08,1.4676E-01,5.3777E+08,1.4819E-01,5.3865E+08,
	1.4962E-01,5.3951E+08,1.5106E-01,5.4037E+08,1.5249E-01,5.4122E+08,1.5392E-01,5.4206E+08,
	1.5535E-01,5.4290E+08,1.5678E-01,5.4373E+08,1.5822E-01,5.4455E+08,1.5965E-01,5.4537E+08,
	1.6108E-01,5.4618E+08,1.6251E-01,5.4699E+08,1.6394E-01,5.4779E+08,1.6538E-01,5.4858E+08,
	1.6681E-01,5.4937E+08,1.6824E-01,5.5016E+08,1.6967E-01,5.5093E+08,1.7111E-01,5.5171E+08,
	1.7254E-01,5.5247E+08,1.7397E-01,5.5323E+08,1.7540E-01,5.5399E+08,1.7683E-01,5.5474E+08,
	1.7827E-01,5.5549E+08,1.7970E-01,5.5623E+08,1.8113E-01,5.5696E+08,1.8256E-01,5.5769E+08,
	1.8399E-01,5.5842E+08,1.8543E-01,5.5914E+08,1.8686E-01,5.5986E+08,1.8829E-01,5.6057E+08,
	1.8972E-01,5.6128E+08,1.9116E-01,5.6198E+08,1.9259E-01,5.6268E+08,1.9402E-01,5.6337E+08,
	1.9545E-01,5.6406E+08,1.9688E-01,5.6475E+08,1.9832E-01,5.6543E+08,1.9975E-01,5.6611E+08,
	2.0118E-01,5.6678E+08,2.0261E-01,5.6745E+08,2.0405E-01,5.6812E+08,2.0548E-01,5.6878E+08,
	2.0691E-01,5.6944E+08,2.0834E-01,5.7009E+08,2.0977E-01,5.7074E+08,2.1121E-01,5.7139E+08,
	2.1264E-01,5.7203E+08,2.1407E-01,5.7267E+08,2.1550E-01,5.7331E+08,2.1693E-01,5.7394E+08,
	2.1837E-01,5.7457E+08,2.1980E-01,5.7520E+08,2.2123E-01,5.7582E+08,2.2266E-01,5.7644E+08,
	2.2410E-01,5.7705E+08,2.2553E-01,5.7766E+08,2.2696E-01,5.7827E+08,2.2839E-01,5.7888E+08,
	2.2982E-01,5.7948E+08,2.3126E-01,5.8008E+08,2.3269E-01,5.8068E+08,2.3412E-01,5.8127E+08,
	2.3555E-01,5.8186E+08,2.3698E-01,5.8245E+08,2.3842E-01,5.8303E+08,2.3985E-01,5.8361E+08,
	2.4128E-01,5.8419E+08,2.4271E-01,5.8477E+08,2.4415E-01,5.8534E+08,2.4558E-01,5.8591E+08,
	2.4701E-01,5.8648E+08,2.4844E-01,5.8704E+08,2.4987E-01,5.8760E+08,2.5131E-01,5.8816E+08,
	2.5274E-01,5.8872E+08,2.5417E-01,5.8927E+08,2.5560E-01,5.8982E+08,2.5704E-01,5.9037E+08,
	2.5847E-01,5.9092E+08,2.5990E-01,5.9146E+08,2.6133E-01,5.9200E+08,2.6276E-01,5.9254E+08,
	2.6420E-01,5.9308E+08,2.6563E-01,5.9361E+08,2.6706E-01,5.9414E+08,2.6849E-01,5.9467E+08,
	2.6992E-01,5.9520E+08,2.7136E-01,5.9572E+08,2.7279E-01,5.9624E+08,2.7422E-01,5.9676E+08,
	2.7565E-01,5.9728E+08,2.7709E-01,5.9780E+08,2.7852E-01,5.9831E+08,2.7995E-01,5.9882E+08,
	2.8138E-01,5.9933E+08,2.8281E-01,5.9984E+08,2.8425E-01,6.0034E+08,2.8568E-01,6.0084E+08,
	2.8711E-01,6.0134E+08,2.8854E-01,6.0184E+08,2.8997E-01,6.0234E+08,2.9141E-01,6.0283E+08,
	2.9284E-01,6.0332E+08,2.9427E-01,6.0381E+08,2.9570E-01,6.0430E+08,2.9714E-01,6.0478E+08,
	2.9857E-01,6.0527E+08,3.0000E-01,6.0575E+08,)
Traction=DEFI_FONCTION(
    NOM_PARA='EPSI', NOM_RESU='SIGM', VALE=nl_mat, INTERPOL='LIN', PROL_DROITE='LINEAIRE', PROL_GAUCHE='CONSTANT'
)

S420 = DEFI_MATERIAU(
    ELAS=_F(E=210000000000.0, NU=0.3, RHO=7850), TRACTION=_F(SIGM=Traction,),
)


# Sections

material = AFFE_MATERIAU(
    MODELE=model,
    AFFE=(
		_F(MATER=(S420,), GROUP_MA="elMyBeam_e1_top_fl_sh"),
		_F(MATER=(S420,), GROUP_MA="elMyBeam_e2_top_fl_sh"),
		_F(MATER=(S420,), GROUP_MA="elMyBeam_e3_web_sh"),
		_F(MATER=(S420,), GROUP_MA="elMyBeam_e4_top_fl_sh"),
		_F(MATER=(S420,), GROUP_MA="elMyBeam_e5_top_fl_sh"),

    )
)


# Shell elements:
#   EPAIS: thickness
#   VECTEUR: a direction of reference in the tangent plan

element = AFFE_CARA_ELEM(
        MODELE=model,
        COQUE=(
            _F(
                GROUP_MA=("elMyBeam_e1_top_fl_sh"),
                EPAIS=0.0135,
                VECTEUR=(1.0, 0.0, 0.0),
            ),
            _F(
                GROUP_MA=("elMyBeam_e2_top_fl_sh"),
                EPAIS=0.0135,
                VECTEUR=(1.0, 0.0, 0.0),
            ),
            _F(
                GROUP_MA=("elMyBeam_e3_web_sh"),
                EPAIS=0.0086,
                VECTEUR=(1.0, 0.0, 0.0),
            ),
            _F(
                GROUP_MA=("elMyBeam_e4_top_fl_sh"),
                EPAIS=0.0135,
                VECTEUR=(1.0, 0.0, 0.0),
            ),
            _F(
                GROUP_MA=("elMyBeam_e5_top_fl_sh"),
                EPAIS=0.0135,
                VECTEUR=(1.0, 0.0, 0.0),
            ),

        ),
        POUTRE=(),
    )


# Boundary Conditions
dofs = dict(
    GROUP_NO="bc_nodes",
    DX=0, DY=0, DZ=0, DRX=0, DRY=0, DRZ=0, 
)
Fixed = AFFE_CHAR_MECA(
    MODELE=model, DDL_IMPO=_F(**dofs)
)

# Step Information

grav = AFFE_CHAR_MECA(
    MODELE=model, PESANTEUR=_F(DIRECTION=(0.0, 0.0, 1.0), GRAVITE=-784.8000000000001)
)

timeReel = DEFI_LIST_REEL(DEBUT=0.0, INTERVALLE=_F(JUSQU_A=1.0, NOMBRE=10))
timeInst = DEFI_LIST_INST(METHODE="AUTO", DEFI_LIST=_F(LIST_INST=timeReel))
rampFunc = DEFI_FONCTION(NOM_PARA="INST", VALE=(0.0, 0.0, 1.0, 1.0))

result = STAT_NON_LINE(
    MODELE=model,
    CHAM_MATER=material,
    CARA_ELEM=element,
    COMPORTEMENT=(_F(DEFORMATION="PETIT", RELATION="VMIS_ISOT_TRAC", TOUT="OUI")),
    CONVERGENCE=_F(ARRET="OUI", ITER_GLOB_MAXI=8,),
    EXCIT=(_F(CHARGE=Fixed),_F(CHARGE=Fixed),_F(CHARGE=grav, FONC_MULT=rampFunc)),
    INCREMENT=_F(LIST_INST=timeInst),
    ARCHIVAGE=_F(LIST_INST=timeReel),
)

result = CALC_CHAMP(
    reuse=result, RESULTAT=result,
    CONTRAINTE=("EFGE_ELNO", "EFGE_NOEU", "SIGM_ELNO"),
    DEFORMATION=("EPSI_ELNO", "EPSP_ELNO"),
)

stress = POST_CHAMP(
    EXTR_COQUE=_F(
        NIVE_COUCHE='MOY',
    NOM_CHAM=('SIGM_ELNO', ),
    NUME_COUCHE=1),
    RESULTAT=result
)

stress = CALC_CHAMP(
    reuse=stress,
    CONTRAINTE=('SIGM_NOEU', ),
    RESULTAT=stress
)

strain = POST_CHAMP(
    EXTR_COQUE=_F(
        NIVE_COUCHE='MOY',
    NOM_CHAM=('EPSI_ELNO', ),
    NUME_COUCHE=1),
    RESULTAT=result
)

strainP = POST_CHAMP(
    EXTR_COQUE=_F(
        NIVE_COUCHE='MOY',
    NOM_CHAM=('EPSP_ELNO', ),
    NUME_COUCHE=1),
    RESULTAT=result
)

IMPR_RESU(
    RESU=(
        _F(
            NOM_CHAM=("DEPL", "EFGE_ELNO", "EFGE_NOEU"),
            NOM_CHAM_MED=("DISP", "GEN_FORCES_ELEM", "GEN_FORCES_NODES"),
            RESULTAT=result,
        ),
        _F(
            NOM_CHAM=("SIGM_ELNO", "SIGM_NOEU"),
            NOM_CHAM_MED=("STRESSES_ELEM", "STRESSES_NODES"),
            RESULTAT=stress,
        ),
        _F(
            NOM_CHAM=("EPSI_ELNO",),
            NOM_CHAM_MED=("STRAINS_ELEM",),
            RESULTAT=strain,
        ),
        _F(
            NOM_CHAM=("EPSP_ELNO",),
            NOM_CHAM_MED=("PLASTIC_STRAINS_ELEM",),
            RESULTAT=strainP,
        ),
    ),
    UNITE=80,
)

# Results Information

FIN()
