import ada
from ada.param_models.sweep_example import (
    get_three_sweeps_mesh_data,
)

# ----------------------
# Input paths (many points)
# ----------------------
sweep1_pts = [
    [287.85, 99.917, 513.26],
    [287.85, 100.083, 513.26],
    [287.85, 100.08950561835023, 513.2587059520527],
    [287.85, 100.09502081528021, 513.2550208152801],
    [287.85, 100.09870595205274, 513.2495056183502],
    [287.85, 100.10000000000005, 513.2429999999999],
    [287.85, 100.1, 513.077],
    [287.85, 100.09870595205268, 513.0704943816498],
    [287.85, 100.09502081528017, 513.0649791847198],
    [287.85, 100.0895056183502, 513.0612940479473],
    [287.85, 100.083, 513.06],
    [287.85, 99.917, 513.06],
    [287.85, 99.91049438164977, 513.0612940479473],
    [287.85, 99.90497918471979, 513.0649791847198],
    [287.85, 99.90129404794726, 513.0704943816497],
    [287.85, 99.89999999999995, 513.077],
    [287.85, 99.9, 513.2429999999999],
    [287.85, 99.90129404794732, 513.2495056183501],
    [287.85, 99.90497918471983, 513.2550208152801],
    [287.85, 99.9104943816498, 513.2587059520527],
    [287.85, 99.917, 513.26],
]

sweep2_pts = [
    [287.833, 100.1, 513.26],
    [287.667, 100.1, 513.26],
    [287.66049438164976, 100.1, 513.2587059520527],
    [287.65497918471976, 100.1, 513.2550208152801],
    [287.65129404794726, 100.1, 513.2495056183502],
    [287.6499999999999, 100.1, 513.2429999999999],
    [287.65, 100.1, 513.077],
    [287.65129404794726, 100.1, 513.0704943816498],
    [287.6549791847198, 100.1, 513.0649791847198],
    [287.66049438164976, 100.1, 513.0612940479473],
    [287.667, 100.1, 513.06],
    [287.833, 100.1, 513.06],
    [287.83950561835024, 100.1, 513.0612940479473],
    [287.84502081528024, 100.1, 513.0649791847198],
    [287.84870595205274, 100.1, 513.0704943816497],
    [287.8500000000001, 100.1, 513.077],
    [287.85, 100.1, 513.2429999999999],
    [287.84870595205274, 100.1, 513.2495056183501],
    [287.8450208152802, 100.1, 513.2550208152801],
    [287.83950561835024, 100.1, 513.2587059520527],
    [287.833, 100.1, 513.26],
]

sweep3_pts = [
    [287.833, 99.9, 513.26],
    [287.667, 99.9, 513.26],
    [287.66049438164976, 99.9, 513.2587059520527],
    [287.65497918471976, 99.9, 513.2550208152801],
    [287.65129404794726, 99.9, 513.2495056183502],
    [287.6499999999999, 99.9, 513.2429999999999],
    [287.65, 99.9, 513.077],
    [287.65129404794726, 99.9, 513.0704943816498],
    [287.6549791847198, 99.9, 513.0649791847198],
    [287.66049438164976, 99.9, 513.0612940479473],
    [287.667, 99.9, 513.06],
    [287.833, 99.9, 513.06],
    [287.83950561835024, 99.9, 513.0612940479473],
    [287.84502081528024, 99.9, 513.0649791847198],
    [287.84870595205274, 99.9, 513.0704943816497],
    [287.8500000000001, 99.9, 513.077],
    [287.85, 99.9, 513.2429999999999],
    [287.84870595205274, 99.9, 513.2495056183501],
    [287.8450208152802, 99.9, 513.2550208152801],
    [287.83950561835024, 99.9, 513.2587059520527],
    [287.833, 99.9, 513.26],
]



def main():
    wt = 8e-3
    fillet = [(0, 0), (-wt, 0), (0, wt)]

    profile_y = ada.Direction(0, 0, 1)
    sweep1_profile_normal = [0.0, 1.0, 0.0]
    sweep2_profile_normal = [-1.0, 0.0, 0.0]
    sweep3_profile_normal = [1.0, 0.0, 0.0]
    sweep3_profile_xdir = [0, 1, 0]
    derived_reference = True
    sweep1 = ada.PrimSweep(
        "sweep1",
        sweep1_pts,
        fillet,
        profile_normal=sweep1_profile_normal,
        profile_ydir=profile_y,
        color="red",
        derived_reference=derived_reference,
    )
    sweep2 = ada.PrimSweep(
        "sweep2",
        sweep2_pts,
        fillet,
        profile_normal=sweep2_profile_normal,
        profile_ydir=profile_y,
        color="blue",
        derived_reference=derived_reference,
    )
    sweep3 = ada.PrimSweep(
        "sweep3",
        sweep3_pts,
        fillet,
        profile_normal=sweep3_profile_normal,
        profile_xdir=sweep3_profile_xdir,
        color="green",
        derived_reference=derived_reference,
    )
    sweeps = [
        sweep1,
        sweep2,
        sweep3,
    ]
    mesh_data = get_three_sweeps_mesh_data()
    mesh1_raw = mesh_data[0]
    mesh1 = sweeps[0].solid_trimesh()
    mesh1_raw_vertices = mesh1_raw["vertices"]
    mesh1_vertices = mesh1.vertices.tolist()
    assert len(mesh1_raw_vertices) == len(mesh1_vertices)

    a = ada.Assembly("part") / sweeps
    export_ifc_file = "../temp/swept_shape_example_2.ifc"
    a.to_ifc(export_ifc_file, validate=True)
    a.to_stp("temp/swept_shape_example_2.stp")
    # a = ada.from_ifc(export_ifc_file)
    a.show(stream_from_ifc_store=True)
    a.show(stream_from_ifc_store=False, append_to_scene=True)


if __name__ == "__main__":
    main()
